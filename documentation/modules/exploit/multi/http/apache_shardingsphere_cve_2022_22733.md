## Vulnerable Application
### Overview
Apache ShardingSphere ElasticJob-UI 3.x, including version 3.0.0, as well as prior alpha and beta versions, are 
vulnerable to CVE-2022-22733, a vulnerability that allows an attacker who has a guest account to leak sensitive information
and perform a privilege escalation attack.

This vulnerability occurs because, when logging into the application via a POST request to `/api/login`, the server
returns a response containing a `accessToken` field that contains a base64 encoded value. Upon decoding this value,
an attacker can obtain the root username and password, as well as the guest username and password, in plaintext.

By using these leaked credentials, an attacker can log into the application as the privileged `root` user, and then
perform a privilege escalation attack by using the `/api/data-source/connectTest` endpoint to make a JDBC connection
to an attacker controlled web server.

By hosting a malicious SQL file on the web server, an attacker can execute arbitrary SQL statements on the 
Apache ShardingSphere ElasticJob-UI server by abusing the built in ability to create aliases in SQL that execute
arbitrary commands. By then executing the created alias, the attacker can gain RCE as the `XXX` user.

### Setting up a vulnerable application

1. `sudo docker run -p 8088:8088 -d apache/shardingsphere-elasticjob-lite-ui:3.0.0`

## Verification Steps
Example steps in this format (is also in the PR):

1. Install the application by following the directions above.
1. Start msfconsole
1. Do: `use exploit/multi/http/apache_shardingsphere_cve_2022_22733`
1. Do: `set RHOSTS target`
1. Do: `set JDBC URL_to_your_malicious_sql_script`
1. Do: `exploit`
1. You should get `root` account credentials.

## Options

### JDBC
URL to the malicious SQL file on the HTTP server to retrieve for the JDBC Attack. ex: http://ip:8000/poc.sql.
### PASSWORD
Password for authentication. The default value is `guest` for the guest account that comes with the application.
### USERNAME
The username to authenticate with. The default value is `guest` for the guest account that comes with the application.

## Scenarios
TODO
